{
  "id": null,
  "uid": "stm32-lorawan-final",
  "title": "STM32 LoRaWAN - Vision V1-D",
  "tags": ["lorawan", "stm32", "ttn"],
  "refresh": "15s",
  "time": {"from": "now-2h", "to": "now"},
  "panels": [
    {
      "title": "Confidence %",
      "type": "stat",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: -30m)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> filter(fn: (r) => r[\"_field\"] == \"uplink_message_decoded_payload_confidence\")\n  |> last()"}],
      "gridPos": {"h": 5, "w": 6, "x": 0, "y": 0},
      "fieldConfig": {"defaults": {"unit": "percent", "color": {"mode": "thresholds"}, "thresholds": {"steps": [{"color": "red"}, {"value": 70, "color": "yellow"}, {"value": 90, "color": "green"}]}}}
    },
    {
      "title": "LuminositÃ© (lux)",
      "type": "stat",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: -30m)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> filter(fn: (r) => r[\"_field\"] == \"uplink_message_decoded_payload_lux\")\n  |> last()"}],
      "gridPos": {"h": 5, "w": 6, "x": 6, "y": 0},
      "fieldConfig": {"defaults": {"unit": "lux"}}
    },
    {
      "title": "Ã‰vÃ©nement",
      "type": "stat",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: -30m)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> filter(fn: (r) => r[\"_field\"] == \"uplink_message_decoded_payload_event_class\")\n  |> last()"}],
      "gridPos": {"h": 5, "w": 6, "x": 12, "y": 0},
      "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "thresholds": {"steps": [{"color": "green"}, {"value": 1, "color": "orange"}, {"value": 2, "color": "red"}]}}}
    },
    {
      "title": "RSSI",
      "type": "stat",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: -30m)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> filter(fn: (r) => r[\"_field\"] == \"uplink_message_rx_metadata_0_channel_rssi\")\n  |> last()"}],
      "gridPos": {"h": 5, "w": 6, "x": 18, "y": 0},
      "fieldConfig": {"defaults": {"unit": "dBm", "color": {"mode": "thresholds"}, "thresholds": {"steps": [{"color": "red"}, {"value": -100, "color": "orange"}, {"value": -70, "color": "green"}]}}}
    },
    {
      "title": "Capteurs (Live)",
      "type": "timeseries",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: v.timeRangeStart)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> filter(fn: (r) => contains(value: r[\"_field\"], set: [\"uplink_message_decoded_payload_confidence\", \"uplink_message_decoded_payload_lux\", \"uplink_message_decoded_payload_event_class\"]))"}],
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 5}
    },
    {
      "title": "QualitÃ© Signal",
      "type": "timeseries",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: v.timeRangeStart)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> filter(fn: (r) => contains(value: r[\"_field\"], set: [\"uplink_message_rx_metadata_0_channel_rssi\", \"uplink_message_rx_metadata_0_channel_index\"]))"}],
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 5}
    },
    {
      "title": "Derniers Uplinks STM32",
      "type": "table",
      "targets": [{"query": "from(bucket: \"ttn\")\n  |> range(start: -4h)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"ttn_uplink\")\n  |> pivot(rowKey:[\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n  |> sort(columns: [\"_time\"], desc: true)\n  |> limit(n: 15)"}],
      "transformations": [{"id": "organize", "options": {"renameByName": {"_time": "ğŸ•", "uplink_message_decoded_payload_confidence": "Confidence", "uplink_message_decoded_payload_lux": "Lux", "uplink_message_decoded_payload_event_class": "Event", "uplink_message_rx_metadata_0_channel_rssi": "RSSI"}}}],
      "gridPos": {"h": 10, "w": 24, "x": 0, "y": 13}
    }
  ]
}
